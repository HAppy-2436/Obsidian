# 状态机

## 定义
有限状态机（FSM）是[[时序逻辑电路]]的抽象模型，由有限个状态和状态转移规则组成。分为Mealy型（输出依赖当前状态和输入）和Moore型（输出只依赖当前状态）。状态机通过状态图、状态表描述，用[[触发器]]存储状态，[[组合逻辑电路]]实现状态转移和输出。是数字系统设计的核心方法，用于控制逻辑设计。

## 核心内容
**基本要素**：
1. **状态集合**：有限个状态S = {S₀, S₁, ...}
2. **输入集合**：I = {I₀, I₁, ...}
3. **输出集合**：O = {O₀, O₁, ...}
4. **状态转移函数**：δ: S×I → S
5. **输出函数**：λ: S×I → O（Mealy）或λ: S → O（Moore）

**Mealy型状态机**：
- 输出 = f(当前状态, 当前输入)
- 输出可能有毛刺
- 状态少，响应快

**Moore型状态机**：
- 输出 = f(当前状态)
- 输出稳定，无毛刺
- 状态多，延迟1拍

**描述方法**：
1. **状态图**：
   - 圆圈表示状态
   - 箭头表示转移
   - 标注：输入/输出（Mealy）或输出（Moore）
   
2. **状态表**：
   列出次态和输出

**设计步骤**：
1. **抽象**：文字→状态图
2. **状态化简**：减少冗余状态
3. **状态编码**：二进制、格雷码、独热码
4. **选择触发器**：通常用D触发器
5. **求逻辑方程**：
   - 状态方程
   - 驱动方程
   - 输出方程
6. **画逻辑图**
7. **验证**：仿真测试

**状态编码**：
- **二进制编码**：n位表示2^n个状态，节省触发器
- **格雷码**：相邻状态只变1位，减少[[竞争冒险]]
- **独热码**：n个状态用n位，每位1个触发器，速度快

## 应用场景
数字控制器；通信协议；电梯控制；交通灯控制；自动售货机；CPU指令周期；游戏逻辑。

## 注意事项
- Moore型输出稳定但延迟大
- Mealy型响应快但可能有毛刺
- 状态编码影响电路复杂度
- 必须考虑自启动能力

## 关联知识
与 [[时序逻辑电路]]、[[触发器]]、[[组合逻辑电路]]、[[计数器]] 相关。
